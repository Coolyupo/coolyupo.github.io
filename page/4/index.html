<!DOCTYPE html>
<html lang="zh-tw">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.8.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="紀錄一些我的學習筆記">
<meta property="og:type" content="website">
<meta property="og:title" content="阿熊的日常筆記">
<meta property="og:url" content="http://example.com/page/4/index.html">
<meta property="og:site_name" content="阿熊的日常筆記">
<meta property="og:description" content="紀錄一些我的學習筆記">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="GuruBear">
<meta property="article:tag" content="GuruBear">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-tw","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>阿熊的日常筆記</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">阿熊的日常筆記</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">GuruBear's note</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">GuruBear</p>
  <div class="site-description" itemprop="description">紀錄一些我的學習筆記</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">40</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/09/01/ithome-13th-day01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/09/01/ithome-13th-day01/" class="post-title-link" itemprop="url">HomeLab 30天，胡搞瞎搞亂弄一通，Day01，旅途的起點</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-09-01 20:05:54" itemprop="dateCreated datePublished" datetime="2021-09-01T20:05:54+08:00">2021-09-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-16 19:29:57" itemprop="dateModified" datetime="2021-11-16T19:29:57+08:00">2021-11-16</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Day01，旅途的起點"><a href="#Day01，旅途的起點" class="headerlink" title="Day01，旅途的起點"></a>Day01，旅途的起點</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>這次預計用這30天，來執行一輪亂七八糟的HomeLab，內容將會涵蓋許多不同領域的範疇<strong>但不會探究</strong>，而涵蓋的範圍有些是我所擅長的、有些是我不擅長、有些是已經在工作運行一陣子了的，也將有些是第一次接觸的。這一切的一切，僅僅作為我對於我自己自我成長的要求，當然如果你因為過於無聊，或其他緣故而看到這系列的文章，又產生想法的話，也歡迎指教與鞭策。</p>
<blockquote>
<p>只求小力一點XD。</p>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/09/01/ithome-13th-day01/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/08/postgresql-backup-restore/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/08/postgresql-backup-restore/" class="post-title-link" itemprop="url">postgreSQL simply backup&restore</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-12-08 11:37:42" itemprop="dateCreated datePublished" datetime="2020-12-08T11:37:42+08:00">2020-12-08</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 11:39:20" itemprop="dateModified" datetime="2021-11-17T11:39:20+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li>postgres (PostgreSQL) 10.11</li>
</ul>
<p><img src="https://i.imgur.com/EjsRn9o.png"></p>
<p><img src="https://i.imgur.com/AwoeEd0.png"></p>
<h2 id="Backup"><a href="#Backup" class="headerlink" title="Backup"></a>Backup</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pg_dump -h $db_host -U $POSTGRES_USER -C -c -Fc -f /mnt/$(date +\&quot;%Y-%m-%d\&quot;).dump $database</span><br></pre></td></tr></table></figure>

<h2 id="Restore"><a href="#Restore" class="headerlink" title="Restore"></a>Restore</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># create database</span></span> </span><br><span class="line">psql -U postgres</span><br><span class="line">create database $database;</span><br><span class="line">create user $database_user;</span><br><span class="line">alter role $database_user with password &#x27;$database_userpassword&#x27;</span><br><span class="line">grant all privileges on database $database to $database_user;</span><br><span class="line">alter database $database owner to $database_user;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># create extensions which you need</span></span></span><br><span class="line">\c $database</span><br><span class="line">CREATE EXTENSION postgis;</span><br><span class="line">CREATE EXTENSION postgis_topology;</span><br><span class="line">CREATE EXTENSION fuzzystrmatch;</span><br><span class="line">CREATE EXTENSION postgis_tiger_geocoder;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># pg_restore</span></span></span><br><span class="line">pg_restore -h $db_host -U $POSTGRES_USER -d $database $(date +\&quot;%Y-%m-%d\&quot;).dump</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/01/etcd-backup-restore/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/01/etcd-backup-restore/" class="post-title-link" itemprop="url">etcd_backup&restore</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-10-01 10:58:47" itemprop="dateCreated datePublished" datetime="2020-10-01T10:58:47+08:00">2020-10-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 11:38:21" itemprop="dateModified" datetime="2021-11-17T11:38:21+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ETCD-Backup-Restore"><a href="#ETCD-Backup-Restore" class="headerlink" title="ETCD Backup/Restore"></a>ETCD Backup/Restore</h1><ul>
<li>etcd v3.3.10</li>
</ul>
<h2 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ETCDCTL_API=3 etcdctl --endpoints https://127.0.0.1:2379 --cacert=/etc/ssl/etcd/ssl/ca.pem --cert=/etc/ssl/etcd/ssl/member-xxxxx-ubuntu-host01.pem --key /etc/ssl/etcd/ssl/member-xxxxx-ubuntu-host01-key.pem snapshot save /data/ETCD_Backup/$(date +&quot;%Y-%m-%d&quot;)-snapshot.db</span><br></pre></td></tr></table></figure>

<h2 id="restore"><a href="#restore" class="headerlink" title="restore"></a>restore</h2><h3 id="standalone-non-tls"><a href="#standalone-non-tls" class="headerlink" title="standalone(non-tls)"></a>standalone(non-tls)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># create temp container</span></span> </span><br><span class="line">docker run -v /backup_data:/mnt -e ETCDCTL_API=3 -it -v /etcd_data:/var/lib/etcd --entrypoint &quot;/bin/sh&quot; quay.io/coreos/etcd:v3.3.10</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># restore command</span></span></span><br><span class="line">ETCDCTL_API=3 etcdctl snapshot restore 2020-12-21-snapshot.db --name=test1 --initial-cluster test1=http://192.168.56.10:2380 \</span><br><span class="line">--initial-cluster-token test-token \</span><br><span class="line">--initial-advertise-peer-urls http://192.168.56.10:2380 \</span><br><span class="line">--data-dir /var/lib/etcd/test</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># restart etcd</span></span></span><br><span class="line">docker run -d --name etcd \</span><br><span class="line">-p 2379:2379 \</span><br><span class="line">-p 2380:2380 \</span><br><span class="line">-v /mnt/test:/var/lib/etcd \</span><br><span class="line">quay.io/coreos/etcd:v3.3.10 \</span><br><span class="line">/usr/local/bin/etcd \</span><br><span class="line">--data-dir=/var/lib/etcd \</span><br><span class="line">--name test1 \</span><br><span class="line">--initial-advertise-peer-urls http://192.168.56.10:2380 \</span><br><span class="line">--listen-peer-urls http://0.0.0.0:2380 \</span><br><span class="line">--advertise-client-urls http://192.168.56.10:2379 \</span><br><span class="line">--listen-client-urls http://0.0.0.0:2379 \</span><br><span class="line">--initial-cluster-token test-token</span><br></pre></td></tr></table></figure>

<blockquote>
<p>check value</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ETCDCTL_API=3 etcdctl get / --prefix --keys-only</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/naAD4yU.png"></p>
<p><img src="https://i.imgur.com/i9oYuBB.png"></p>
<h3 id="cluster-tls"><a href="#cluster-tls" class="headerlink" title="cluster(tls)"></a>cluster(tls)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># restore snapshot on each node</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ETCDCTL_API=3 etcdctl snapshot restore snapshot.db \</span></span><br><span class="line"><span class="bash">  --name etcd1 \</span></span><br><span class="line"><span class="bash">  --cacert /etc/ssl/etcd/ssl/ca.pem \</span></span><br><span class="line"><span class="bash">  --cert /etc/ssl/etcd/ssl/member-xxxxx-ubuntu-host01.pem \</span></span><br><span class="line"><span class="bash">  --key /etc/ssl/etcd/ssl/member-xxxxx-ubuntu-host01-key.pem \</span></span><br><span class="line"><span class="bash">  --initial-cluster etcd1=https://[host01]:2380,etcd2=https://[host02]:2380,etcd3=https://[host03]:2380 \</span></span><br><span class="line"><span class="bash">  --initial-cluster-token k8s_etcd \</span></span><br><span class="line"><span class="bash">  --initial-advertise-peer-urls https://[host01]:2380 \</span></span><br><span class="line"><span class="bash">  --data-dir /var/lib/etcd</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ETCDCTL_API=3 etcdctl snapshot restore snapshot.db \</span></span><br><span class="line"><span class="bash">  --name etcd2 \</span></span><br><span class="line"><span class="bash">  --cacert /etc/ssl/etcd/ssl/ca.pem \</span></span><br><span class="line"><span class="bash">  --cert /etc/ssl/etcd/ssl/member-xxxxx-ubuntu-host02.pem \</span></span><br><span class="line"><span class="bash">  --key /etc/ssl/etcd/ssl/member-xxxxx-ubuntu-host02-key.pem \</span></span><br><span class="line"><span class="bash">  --initial-cluster etcd1=https://[host01]:2380,etcd2=https://[host02]:2380,etcd3=https://[host03]:2380 \</span></span><br><span class="line"><span class="bash">  --initial-cluster-token k8s_etcd \</span></span><br><span class="line"><span class="bash">  --initial-advertise-peer-urls https://[host02]:2380 \</span></span><br><span class="line"><span class="bash">  --data-dir /var/lib/etcd</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ETCDCTL_API=3 etcdctl snapshot restore snapshot.db \</span></span><br><span class="line"><span class="bash">  --name etcd3 \</span></span><br><span class="line"><span class="bash">  --cacert /etc/ssl/etcd/ssl/ca.pem \</span></span><br><span class="line"><span class="bash">  --cert /etc/ssl/etcd/ssl/member-xxxxx-ubuntu-host03.pem \</span></span><br><span class="line"><span class="bash">  --key /etc/ssl/etcd/ssl/member-xxxxx-ubuntu-host03-key.pem \</span></span><br><span class="line"><span class="bash">  --initial-cluster etcd1=https://[host01]:2380,etcd2=https://[host02]:2380,etcd3=https://[host03]:2380 \</span></span><br><span class="line"><span class="bash">  --initial-cluster-token k8s_etcd \</span></span><br><span class="line"><span class="bash">  --initial-advertise-peer-urls https://[host03]:2380 \</span></span><br><span class="line"><span class="bash">  --data-dir /var/lib/etcd</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># restart etcd on each node with etcd.env</span></span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>[etcd-systemd]<br><img src="https://i.imgur.com/w2Kmqf0.png"></p>
</blockquote>
<blockquote>
<p>[etcd-env]<br><img src="https://i.imgur.com/nsiXhFc.png"></p>
</blockquote>
<blockquote>
<p>check status</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">etcdctl \</span><br><span class="line">--endpoints=https://[host01]:2379 \</span><br><span class="line">--ca-file=ca.pem \</span><br><span class="line">--cert-file=member-xxxxx-ubuntu-host01.pem \</span><br><span class="line">--key-file=member-xxxxx-ubuntu-host01-key.pem \</span><br><span class="line">member list</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/04/03/wsl1-docker-desktop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/03/wsl1-docker-desktop/" class="post-title-link" itemprop="url">Docker in WSL1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-04-03 11:17:00" itemprop="dateCreated datePublished" datetime="2020-04-03T11:17:00+08:00">2020-04-03</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 11:28:16" itemprop="dateModified" datetime="2021-11-17T11:28:16+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>2021/11/17更新，docker desktop前陣子已調整授權，有打算使用的需要去看一下唷<a target="_blank" rel="noopener" href="https://www.docker.com/blog/updating-product-subscriptions/?fbclid=IwAR2y_QqM-Gz94VtrKdYgtc4uXK6flaZhDAZgifBgrEe_dCTC5liExYE7MbI">https://www.docker.com/blog/updating-product-subscriptions/?fbclid=IwAR2y_QqM-Gz94VtrKdYgtc4uXK6flaZhDAZgifBgrEe_dCTC5liExYE7MbI</a></p>
</blockquote>
<h1 id="Docker-in-WSL1"><a href="#Docker-in-WSL1" class="headerlink" title="Docker in WSL1"></a>Docker in WSL1</h1><p>Enable hyper-v</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dism.exe /Online /Enable-Feature:Microsoft-Hyper-V-All</span><br><span class="line">bcdedit /set hypervisorlaunchtype auto</span><br></pre></td></tr></table></figure>

<p>OS: docker-win10-pro <a target="_blank" rel="noopener" href="https://hub.docker.com/editions/community/docker-ce-desktop-windows/">DownLoad-Link</a></p>
<p>安裝完畢調整設定</p>
<p><img src="https://i.imgur.com/ikzv9Vo.png"></p>
<p>打開WSL(<a target="_blank" rel="noopener" href="https://nickjanetakis.com/blog/setting-up-docker-for-windows-and-wsl-to-work-flawlessly">參考連結</a> 照著做下面這些安裝docker-ce)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Update the apt package list.</span></span></span><br><span class="line">sudo apt-get update -y</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Install Docker&#x27;s package dependencies.</span></span></span><br><span class="line">sudo apt-get install -y \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    software-properties-common</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Download and add Docker&#x27;s official public PGP key.</span></span></span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Verify the fingerprint.</span></span></span><br><span class="line">sudo apt-key fingerprint 0EBFCD88</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Add the `stable` channel&#x27;s Docker upstream repository.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment">## If you want to live on the edge, you can change &quot;stable&quot; below to &quot;test&quot; or</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># &quot;nightly&quot;. I highly recommend sticking with stable!</span></span></span><br><span class="line">sudo add-apt-repository \</span><br><span class="line">   &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span><br><span class="line"><span class="meta">   $</span><span class="bash">(lsb_release -cs) \</span></span><br><span class="line"><span class="bash">   stable<span class="string">&quot;</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"># Update the apt package list (for the new apt repo).</span></span></span><br><span class="line">sudo apt-get update -y</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"># Install the latest version of Docker CE.</span></span></span><br><span class="line">sudo apt-get install -y docker-ce</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"># Allow your user to access the Docker CLI without needing root access.</span></span></span><br><span class="line">sudo usermod -aG docker $USER</span><br></pre></td></tr></table></figure>

<p>先去下載docker-compose</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.26.0/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br><span class="line">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
<p>最後編輯寫入docker_host設定至.zshrc</p>
<blockquote>
<p>此處使用的是zsh shell 如果是bash則要寫入.bashrc諸如此類……目前看起來wsl不會預設載入/etc/profile 所以只能寫在這</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;export DOCKER_HOST=tcp://localhost:2375&quot; &gt;&gt; ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>重開你的WSL</p>
<p><img src="https://i.imgur.com/V0OF3jR.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/04/02/zsh-in-wsl1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/02/zsh-in-wsl1/" class="post-title-link" itemprop="url">zsh in wsl1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-04-02 11:17:00" itemprop="dateCreated datePublished" datetime="2020-04-02T11:17:00+08:00">2020-04-02</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 11:28:25" itemprop="dateModified" datetime="2021-11-17T11:28:25+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="zsh"><a href="#zsh" class="headerlink" title="zsh"></a>zsh</h2><p>安裝zsh並指定為default shell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install zsh</span><br><span class="line">chsh -s $(which zsh)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>重開 WSL</p>
<p>按下0 產出預設 .zshrc</p>
<p>install oh-my-zsh (zsh framework) </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c &quot;$(wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)&quot;</span><br></pre></td></tr></table></figure>
<p>install themes(可不做或選其他)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $ZSH_CUSTOM/themes</span><br><span class="line">wget https://raw.githubusercontent.com/caiogondim/bullet-train-oh-my-zsh-theme/master/bullet-train.zsh-theme</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure>

<p>update theme’s parameter</p>
<p><img src="https://i.imgur.com/Iu7hgr7.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;export TERM=&quot;xterm-256color&quot;&#x27; &gt;&gt; ~/.zshrc</span><br><span class="line">source ~/.zshrc </span><br></pre></td></tr></table></figure>
<p>可以得到的結果<br><img src="https://i.imgur.com/n3p8y34.png"></p>
<p><img src="https://i.imgur.com/YfM0JCK.png"></p>
<blockquote>
<p>其他主題，或是挑選字型<br><a target="_blank" rel="noopener" href="https://github.com/powerline/fonts">powerline 字形-設定在windows</a><br><a target="_blank" rel="noopener" href="https://github.com/unixorn/awesome-zsh-plugins#themes">zsh-themes</a></p>
</blockquote>
<h2 id="WSLtty"><a href="#WSLtty" class="headerlink" title="WSLtty"></a>WSLtty</h2><blockquote>
<p>預設的wsl app 是以windows cmd啟動，cmd的字型顯示不出一些符號看了很不舒服。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/mintty/wsltty/releases">直接下載安裝即可</a></p>
<p><img src="https://i.imgur.com/0vVCGnz.png"></p>
<p>喜歡使用commad的則改為</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">wsl-&gt;</span><span class="bash"> wsl.bat</span></span><br><span class="line">      wsl~.bat</span><br><span class="line">      </span><br><span class="line"><span class="meta">ubuntu-&gt;</span><span class="bash"></span></span><br><span class="line"><span class="bash">      Ubuntu-18.04.bat</span></span><br><span class="line">      Ubuntu-18.04~.bat</span><br></pre></td></tr></table></figure>

<p>下圖：上面的是WSLtty啟動的terminal 可以顯示出 ✘，預設的則不行。<br><img src="https://i.imgur.com/0GSQMZN.png"></p>
<p>再來這裡編輯config檔案(<a target="_blank" rel="noopener" href="https://github.com/mintty/mintty/wiki/Tips">可以參考mintty的設定</a>)</p>
<p><em>C:\Users\user\AppData\Roaming\wsltty</em></p>
<p><img src="https://i.imgur.com/6VtmDEe.png"></p>
<h2 id="ref："><a href="#ref：" class="headerlink" title="ref："></a>ref：</h2><p><a target="_blank" rel="noopener" href="https://blog.miniasp.com/post/2019/02/09/Useful-tool-WSLtty-Mintty-as-a-terminal-for-WSL">https://blog.miniasp.com/post/2019/02/09/Useful-tool-WSLtty-Mintty-as-a-terminal-for-WSL</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/04/01/wsl1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/01/wsl1/" class="post-title-link" itemprop="url">wsl1&virtualbox+vagrant</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-04-01 11:17:00" itemprop="dateCreated datePublished" datetime="2020-04-01T11:17:00+08:00">2020-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 11:29:50" itemprop="dateModified" datetime="2021-11-17T11:29:50+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="wsl1"><a href="#wsl1" class="headerlink" title="wsl1"></a>wsl1</h2><blockquote>
<p>這邊沒有選擇使用wsl2，因為這邊的主工作環境還是windows居多，若使用wsl2 hyper-v會需要開啟，且virtualbox等會需要安裝相依版本在wsl2內(尚未確定是否會產生其他問題)</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># powershell</span></span></span><br><span class="line">dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart</span><br></pre></td></tr></table></figure>
<p>重開機 -&gt; Microsoft Store -&gt; 選擇作業系統</p>
<p><img src="https://i.imgur.com/kMSDLFN.png"></p>
<h2 id="安裝-VirtualBox-5-2"><a href="#安裝-VirtualBox-5-2" class="headerlink" title="安裝 VirtualBox 5.2"></a>安裝 VirtualBox 5.2</h2><p><a target="_blank" rel="noopener" href="https://www.virtualbox.org/wiki/Download_Old_Builds_5_2">Donwload Link</a></p>
<p><img src="https://i.imgur.com/aqoxrPp.png"></p>
<p><img src="https://i.imgur.com/nEJanFd.png"></p>
<p>可能會需要關掉hyper-v</p>
<blockquote>
<p>若要使用docker-for-windows 要自行切換<br>這邊要使用vagrant+virtualbox需關閉</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># powershell</span></span></span><br><span class="line"></span><br><span class="line">dism.exe /Online /Disable-Feature:Microsoft-Hyper-V</span><br><span class="line"></span><br><span class="line">bcdedit /set hypervisorlaunchtype off</span><br></pre></td></tr></table></figure>
<p>要給wsl的vagrant使用，所以設定環境變數在系統中(根據安裝路徑)<br><img src="https://i.imgur.com/gtsXQwI.png"></p>
<h2 id="vagrant"><a href="#vagrant" class="headerlink" title="vagrant"></a>vagrant</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># wsl</span></span></span><br><span class="line">sudo apt install vagrant</span><br></pre></td></tr></table></figure>

<p>本篇的vagrant組合目錄需要位於windows的目錄下</p>
<p><img src="https://i.imgur.com/wFJwIGz.png"></p>
<p><img src="https://i.imgur.com/ienqd48.png"></p>
<p>使用vagrant指令時要添加vagrant的wsl變數</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># wsl</span></span></span><br><span class="line">export VAGRANT_WSL_ENABLE_WINDOWS_ACCESS=&quot;1&quot;</span><br><span class="line">vagrant up</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/K3sh7Pj.png"></p>
<p><img src="https://i.imgur.com/2gatuVg.png"></p>
<p><img src="https://i.imgur.com/OxnFlAN.png"></p>
<h2 id="others"><a href="#others" class="headerlink" title="others"></a>others</h2><p>開回hyper-v</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># powershell</span></span></span><br><span class="line">dism.exe /Online /Enable-Feature:Microsoft-Hyper-V-All</span><br><span class="line">bcdedit /set hypervisorlaunchtype auto</span><br></pre></td></tr></table></figure>

<h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-tw/windows/wsl/install-win10">https://docs.microsoft.com/zh-tw/windows/wsl/install-win10</a><br><a target="_blank" rel="noopener" href="https://william-yeh.net/post/2019/04/wsl-ansible-vagrant/">https://william-yeh.net/post/2019/04/wsl-ansible-vagrant/</a><br><a target="_blank" rel="noopener" href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/01/30/jestonNano-k3s/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/01/30/jestonNano-k3s/" class="post-title-link" itemprop="url">k3s x jeston nano 隨手記</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-01-30 12:00:43" itemprop="dateCreated datePublished" datetime="2020-01-30T12:00:43+08:00">2020-01-30</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 12:05:43" itemprop="dateModified" datetime="2021-11-17T12:05:43+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Done"><a href="#Done" class="headerlink" title="Done"></a>Done</h2><table>
<thead>
<tr>
<th>OS</th>
<th>hardware</th>
<th>master</th>
<th>node</th>
</tr>
</thead>
<tbody><tr>
<td>ubuntu18.04(official)</td>
<td>vm in ds718+(4vCores、8gb ram)</td>
<td>V</td>
<td></td>
</tr>
<tr>
<td>ubuntu18.04(jeston)</td>
<td>jeston nano(NVIDIA Tegra X1)</td>
<td></td>
<td>V</td>
</tr>
</tbody></table>
<ul>
<li>K3S預設使用containerd。<ul>
<li>master我隨便用直接使用containerd</li>
<li>node因nvidia container 僅 support docker、lxc、cri-o  所以改用docker搭建</li>
</ul>
</li>
<li>etcd 上層協議不變下層改用SQL lite轉譯，節點之間有抽象的etcd socket。</li>
<li>rancher的框架master預設是可以schedule的，不想要需自己重上taint。</li>
<li>目前未指定CNI(尚未測試是否無法溝通)，節點上有產出svclb-traefik的daemonset應該是作為取代kubeproxy的功能。</li>
<li>預設會幫你直接安裝traefik ingress controller，若要取消可在安裝選項上取消。</li>
<li>真的是非常簡單安裝、亦可一鍵取消安裝。</li>
</ul>
<p><img src="https://i.imgur.com/uzz5yZ2.png"></p>
<p><img src="https://i.imgur.com/RUTM2gD.png"></p>
<h2 id="Future"><a href="#Future" class="headerlink" title="Future"></a>Future</h2><ul>
<li>檢查CNI部分</li>
<li>試跑TensorFlow/TensorRT</li>
<li>跟之前跑的Jupyter sample上的usb camera搭上關係。</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/12/01/keepalived-story/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/12/01/keepalived-story/" class="post-title-link" itemprop="url">keepalived的小故事</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-12-01 12:06:04" itemprop="dateCreated datePublished" datetime="2019-12-01T12:06:04+08:00">2019-12-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 12:09:37" itemprop="dateModified" datetime="2021-11-17T12:09:37+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Keepalived的編譯小故事"><a href="#Keepalived的編譯小故事" class="headerlink" title="Keepalived的編譯小故事"></a>Keepalived的編譯小故事</h1><h2 id="前情提要"><a href="#前情提要" class="headerlink" title="前情提要"></a>前情提要</h2><blockquote>
<p>在Ubuntu 18.04 透過apt-get install下來的keepalived 預設搭載的是v1.3.9，可是這個版本在18.04上VIP failover會有bug(被systemd-networkd干擾)。<br>可以在有VIP的機器上面，透過幾個指令檢查。</p>
</blockquote>
<ol>
<li>檢查keepalived狀態 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status keepalived</span><br></pre></td></tr></table></figure>
<img src="https://i.imgur.com/EkjoFds.png"></li>
</ol>
<ol start="2">
<li>查看VIP(191)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr show eth0 </span><br></pre></td></tr></table></figure>
<img src="https://i.imgur.com/eLUizkG.png"></li>
</ol>
<ol start="3">
<li>手動刪除VIP<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr del 10.220.201.191 dev eth0</span><br></pre></td></tr></table></figure>
此時如果是正常的keepalived，再次執行步驟1應該可以看到VIP競選的過程，而沒意外的話擁有VIP的這台會再度成為Master(最高權限)，同理再次執行步驟2也可以看到191的VIP顯示，如果沒有就是有bug的版本了~ </li>
</ol>
<h2 id="自行編譯-Keepalived"><a href="#自行編譯-Keepalived" class="headerlink" title="自行編譯 Keepalived"></a>自行編譯 Keepalived</h2><p>目前幾台18.04ubuntu的kernel版本都相去不遠，所以挑一台進行編譯(我是直接用WSL)，從官網先找了個2.0.0版本試試。</p>
<blockquote>
<p>如果kernel版本相差很多就要從該機器上重新build比較保險</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/acassen/keepalived/archive/v2.0.0.tar.gz</span><br><span class="line">tar xvf v2.0.0.tar.gz -C</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install build-essential pkg-config automake autoconf</span><br><span class="line">apt-get install iptables-dev libipset-dev libnl-3-dev libnl-genl-3-dev libssl-dev</span><br></pre></td></tr></table></figure>
<p>以上為必要的，根據<a target="_blank" rel="noopener" href="https://github.com/acassen/keepalived/blob/master/INSTALL">官網</a>說法若有不同需求功能則需要安裝不同套建，參考如下<br><img src="https://i.imgur.com/QaEj2VH.png"></p>
<p>接著</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd keepalived-2.0.0</span><br><span class="line">./build_setup</span><br><span class="line">./configure</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>編譯完成後可以在目錄下的bin裡面找到，而因為我已經安裝過舊版的keepalived了，只要將新編譯過後的keepalived抽換原先舊的，或是調整systemd的設定檔，最後下指令重啟系統服務。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart keepalived</span><br></pre></td></tr></table></figure>
<p>如果完全未安裝的也可以接續剛剛的make下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make install</span><br></pre></td></tr></table></figure>

<blockquote>
<p>理論上他會幫你做基本安裝設定並以init srcipt的方式去啟動keepalived，不過這邊都是採systemd的方式所以就不執行也不討論了。</p>
</blockquote>
<p>最後再回到前面的測試方式去測試是否成功~</p>
<h2 id="參考來源"><a href="#參考來源" class="headerlink" title="參考來源"></a>參考來源</h2><p><a target="_blank" rel="noopener" href="https://github.com/acassen/keepalived/issues/836">Keepalived ignorant of systemd-networkd removing VIPs</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/acassen/keepalived">https://github.com/acassen/keepalived</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/04/01/simple-tmux-guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/04/01/simple-tmux-guide/" class="post-title-link" itemprop="url">simple tmux guide</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2019-04-01 12:13:05" itemprop="dateCreated datePublished" datetime="2019-04-01T12:13:05+08:00">2019-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 12:17:43" itemprop="dateModified" datetime="2021-11-17T12:17:43+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="simple-tmux-guide"><a href="#simple-tmux-guide" class="headerlink" title="simple tmux guide"></a>simple <em>tmux</em> guide</h1><h2 id="新增Pannel"><a href="#新增Pannel" class="headerlink" title="新增Pannel"></a>新增Pannel</h2><ol>
<li><code>ctrl + b</code>    <code>shift + &quot;</code> </li>
</ol>
<p><img src="https://i.imgur.com/jbNCEz1.png"></p>
<h2 id="切換Pannel"><a href="#切換Pannel" class="headerlink" title="切換Pannel"></a>切換Pannel</h2><ol>
<li><code>ctrl + b</code>  <code>pgup</code> or <code>ctrl + b</code>  <code>pgdn</code> </li>
</ol>
<h2 id="刪除當前Pannel"><a href="#刪除當前Pannel" class="headerlink" title="刪除當前Pannel"></a>刪除當前Pannel</h2><ol>
<li><code>ctrl + b</code> <code>x</code></li>
</ol>
<p><img src="https://i.imgur.com/QjFu72S.png"></p>
<h2 id="設定Pannel同步"><a href="#設定Pannel同步" class="headerlink" title="設定Pannel同步"></a>設定Pannel同步</h2><ol>
<li><code>ctrl + b</code> <code>shift + :</code> </li>
<li><code>set synchronize-panes on</code></li>
</ol>
<h2 id="取消Pannel同步"><a href="#取消Pannel同步" class="headerlink" title="取消Pannel同步"></a>取消Pannel同步</h2><ol>
<li><code>ctrl + b</code> <code>shift + :</code></li>
<li><code>set synchronize-panes off</code></li>
</ol>
<p><img src="https://i.imgur.com/FUEyrol.png"></p>
<h2 id="適當地調整Panel畫面"><a href="#適當地調整Panel畫面" class="headerlink" title="適當地調整Panel畫面"></a>適當地調整Panel畫面</h2><p>有5個常用的預設指令可以使用，首先使用tmux產出5個Pannel，接著使用下列指令。</p>
<ol>
<li><code>ctrl + b</code> <code>alt + 1</code></li>
</ol>
<p><img src="https://i.imgur.com/jfXnUgL.png"></p>
<ol start="2">
<li><code>ctrl + b</code> <code>alt + 2</code></li>
</ol>
<p><img src="https://i.imgur.com/6UTypFw.png"></p>
<ol start="3">
<li><code>ctrl + b</code> <code>alt + 3</code></li>
</ol>
<p><img src="https://i.imgur.com/RUCFAfa.png"></p>
<ol start="4">
<li><code>ctrl + b</code> <code>alt + 4</code></li>
</ol>
<p><img src="https://i.imgur.com/VHZzsYw.png"></p>
<ol start="5">
<li><code>ctrl + b</code> <code>alt + 5</code> (平均分割)</li>
</ol>
<p><img src="https://i.imgur.com/shfjQ0V.png"></p>
<h2 id="其他更多指令"><a href="#其他更多指令" class="headerlink" title="其他更多指令"></a>其他更多指令</h2><p><a target="_blank" rel="noopener" href="https://gist.github.com/ryerh/14b7c24dfd623ef8edc7">網友分享</a><br><a target="_blank" rel="noopener" href="https://larrylu.blog/tmux-33a24e595fbc">tmux 介紹</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/07/09/oop-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GuruBear">
      <meta itemprop="description" content="紀錄一些我的學習筆記">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="阿熊的日常筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/07/09/oop-note/" class="post-title-link" itemprop="url">SOLID筆記</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-07-09 19:15:21" itemprop="dateCreated datePublished" datetime="2018-07-09T19:15:21+08:00">2018-07-09</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-11-17 10:23:08" itemprop="dateModified" datetime="2021-11-17T10:23:08+08:00">2021-11-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>過去聽過保哥講座時紀錄下的筆記<br>抽象：需求-&gt;Class<br>封裝： public/private/protected<br>繼承：重複使用既定class<br>多型：polymorphism<br>多載 : -&gt; 相同名字function可傳不同參數，執行不同功能。<br>Virtual -&gt; 允許被override<br>C# Module =&gt; class、method……<br><strong>高內聚 Cohesion 一次做一件事情 -&gt; 可獨立運作<br>低耦合 Coupling 模組與模組之間相依性低，不會互相影響<br>低耦合 -&gt; 帶來低內聚問題。</strong></p>
</blockquote>
<h2 id="SOLID"><a href="#SOLID" class="headerlink" title="SOLID"></a>SOLID</h2><ul>
<li><p>原則<br>  可以寫出比較好的程式碼<br>  能夠判斷程式碼的好壞</p>
<ul>
<li>單一責任原則 SRP(single Responsibility Principle)<ul>
<li>理論一個類別只有一個責任</li>
<li>當責任太多，意味者應該可以被切割-&gt;定義新class</li>
<li>提升高內聚</li>
<li>原則的背後需要根據需求(有重複利用需求、未來需求)</li>
<li>如何確認類別被賦予過多責任？<ul>
<li>副作用：導致高耦合</li>
<li>不瞭解需求不要用SRP</li>
<li>SRP Solid 最簡單但最難做到</li>
<li><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/visualstudio/modeling/create-layer-diagrams-from-your-code">https://docs.microsoft.com/en-us/visualstudio/modeling/create-layer-diagrams-from-your-code</a></li>
</ul>
</li>
</ul>
</li>
<li>開放封閉原則OCP (Open Closed Principle)<ul>
<li>開放擴充、封閉修改<ul>
<li>擴充(繼承、擴充方法)</li>
<li>抽象型別轉為基底新別=&gt; Base = new OOOBase();</li>
<li>使用時機：類別被清楚定義、強調穩定</li>
<li>擔心修改程式碼破壞現有code-&gt;Interface 實作</li>
<li>抽象類別可包含部分實作、Interface不可code=&gt;低耦合</li>
</ul>
</li>
</ul>
</li>
<li>里氏替換原則LSP(Liskov Substitution Principle)<ul>
<li>衍生類別可替換為基底類別、且不發生異常=&gt;子型別可轉換基底型別<ul>
<li>使用Virtual &amp; Override</li>
<li>繼承 or Interface（=&gt;定義基底型別、耦合低）</li>
<li>Warning 很重要</li>
</ul>
</li>
</ul>
</li>
<li>介面隔離原則ISP(Interface Segregation Principle)<ul>
<li>不同需求的屬性與方法放至不同介面</li>
<li>不讓介面包山包海、特定需求另外建一個</li>
<li>介面會變來越多=&gt;多到多少才會剛好?</li>
</ul>
</li>
<li>相依反轉原則Dependency Inversion Principle<ul>
<li>高階不應該依賴於低階、兩者都相依於抽象</li>
<li>DIP =&gt;型別全部相依於抽象<ul>
<li>緊密耦合=&gt;鬆散耦合<ul>
<li>For: 降低耦合、類別相依於抽象、更有效率開發</li>
<li>符合DIP 幾乎符合 OCP &amp; LSP </li>
<li>再多考量SRP &amp; ISP</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">GuruBear</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"coolyupo","repo":"coolyupo.github.io","client_id":"99c63371e36dad946b67","client_secret":"414024fcca2a1bc506558d8e93c7241cdfb66886","admin_user":"coolyupo","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-TW","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"dbb1aad0300bb8f37fa677175e85a293"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
